<!DOCTYPE html>
<html>
<head>
    <title>WebSocket Debug Test</title>
</head>
<body>
    <h1>WebSocket Debug Test</h1>
    <button onclick="testConnection()">Test WebSocket Connection</button>
    <div id="output" style="font-family: monospace; margin-top: 20px; white-space: pre-wrap;"></div>

    <script>
        function log(message) {
            const output = document.getElementById('output');
            const timestamp = new Date().toISOString();
            output.textContent += `[${timestamp}] ${message}\n`;
        }

        function testConnection() {
            log('Starting WebSocket connection test...');

            const url = 'wss://3.16.124.227:8443/';
            log(`Connecting to: ${url}`);

            try {
                const ws = new WebSocket(url);

                ws.onopen = function(event) {
                    log('✅ CONNECTION SUCCESSFUL!');
                    log('Event: ' + JSON.stringify(event, null, 2));
                    ws.close();
                };

                ws.onerror = function(error) {
                    log('❌ CONNECTION ERROR!');
                    log('Error object: ' + JSON.stringify(error, null, 2));
                    log('Error type: ' + error.type);
                    log('Error target: ' + error.target);
                    log('Error target readyState: ' + error.target.readyState);
                };

                ws.onclose = function(event) {
                    log('Connection closed');
                    log('Close code: ' + event.code);
                    log('Close reason: ' + event.reason);
                    log('Was clean: ' + event.wasClean);
                };

                // Log the WebSocket object state
                setTimeout(() => {
                    log('WebSocket readyState after 1s: ' + ws.readyState);
                    log('ReadyState meanings: 0=CONNECTING, 1=OPEN, 2=CLOSING, 3=CLOSED');
                }, 1000);

            } catch (e) {
                log('❌ EXCEPTION THROWN!');
                log('Exception: ' + e.message);
                log('Exception stack: ' + e.stack);
            }
        }
    </script>
</body>
</html>